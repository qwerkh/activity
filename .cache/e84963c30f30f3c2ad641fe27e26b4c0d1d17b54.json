{"metadata":{},"options":{"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining",["pipelineOperator",{"proposal":"minimal"}],"throwExpressions","dynamicImport",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue","filename":"/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue","passPerPreset":false,"envName":"development","cwd":"/home/snr/Desktop/Project/activity","root":"/home/snr/Desktop/Project/activity","plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"transform-runtime","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{}},{"key":"transform-modules-commonjs","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"syntax-flow","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-async-generators","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"transform-arrow-functions","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoped-functions","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-block-scoping","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-classes","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-computed-properties","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-destructuring","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-for-of","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-literals","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-object-super","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-parameters","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-shorthand-properties","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-spread","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-sticky-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-template-literals","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"transform-typeof-symbol","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]}},"options":{}},{"key":"transform-unicode-regex","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"syntax-object-rest-spread","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-object-rest-spread","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-property-literals","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"transform-flow-strip-types","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"ClassPrivateProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ClassPrivateMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"transform-exponentiation-operator","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"proposal-async-generator-functions","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]},"ClassPrivateMethod":{"exit":[null]}},"options":{}}],"presets":[],"generatorOpts":{"filename":"/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue"}},"code":"var draggable;\nmodule.link(\"vuedraggable\", {\n  \"default\": function (v) {\n    draggable = v;\n  }\n}, 0);\nvar formatCurrency;\nmodule.link(\"../../../imports/api/methods/roundCurrency\", {\n  formatCurrency: function (v) {\n    formatCurrency = v;\n  }\n}, 1);\nvar formatCurrencyLast;\nmodule.link(\"../../../imports/api/methods/roundCurrency\", {\n  formatCurrencyLast: function (v) {\n    formatCurrencyLast = v;\n  }\n}, 2);\nvar GeneralFunction;\nmodule.link(\"../../../imports/api/methods/generalFunction\", {\n  GeneralFunction: function (v) {\n    GeneralFunction = v;\n  }\n}, 3);\nvar getCurrencySymbolById;\nmodule.link(\"../../../imports/api/methods/roundCurrency\", {\n  getCurrencySymbolById: function (v) {\n    getCurrencySymbolById = v;\n  }\n}, 4);\nvar WB_waterBillingSetup;\nmodule.link(\"../../collection/waterBillingSetup\", {\n  WB_waterBillingSetup: function (v) {\n    WB_waterBillingSetup = v;\n  }\n}, 5);\nvar compoLang;\nmodule.link(\"../../../both/i18n/lang/elem-label\", {\n  \"default\": function (v) {\n    compoLang = v;\n  }\n}, 6);\nvar Pos_InvoiceReact;\nmodule.link(\"../../collection/posInvoice\", {\n  Pos_InvoiceReact: function (v) {\n    Pos_InvoiceReact = v;\n  }\n}, 7);\nmodule.exportDefault({\n  meteor: {\n    langSession: function () {\n      return Session.get('lang') || \"en\";\n    },\n    disabledRemove: function () {\n      return Session.get(\"canRemove\");\n    },\n    disabledUpdate: function () {\n      return Session.get(\"canUpdate\");\n    }\n  },\n  components: {\n    draggable: draggable\n  },\n  data: function () {\n    return {\n      keyCode: [],\n      refForm: 'posSaleMartFormAdd',\n      multipleSelection: [],\n      posInvoiceId: \"\",\n      loading: false,\n      searchData: '',\n      isSearching: false,\n      typeDiscount: \"\",\n      categoryData: [],\n      productData: [],\n      productDataAll: [],\n      currencySymbol: \"\",\n      posSaleMartData: [],\n      dialogPayMoney: false,\n      posSaleMartForm: {\n        itemId: \"\",\n        itemName: \"\",\n        price: 0,\n        qty: 0,\n        amount: 0,\n        total: 0,\n        netTotal: 0,\n        balanceUnPaid: 0,\n        paid: 0,\n        invoiceDate: moment().toDate(),\n        dueDate: moment().add(1, \"month\").toDate(),\n        invoiceNo: \"\",\n        note: \"\",\n        discountType: \"Amount\",\n        discount: 0,\n        discountValue: 0,\n        termId: \"\",\n        address: \"\",\n        customerId: \"\",\n        isRetail: true,\n        paidUSD: 0,\n        paidKHR: 0,\n        paidTHB: 0,\n        remainUSD: 0,\n        remainKHR: 0,\n        remainTHB: 0,\n        unit1: 1,\n        unit2: 1,\n        totalUnit: 1,\n        desc: \"\",\n        tableId: \"\",\n        rawQty: 0,\n        isReceiveAll: false,\n        balanceNotCut: 0,\n        balanceNotCutFull: 0,\n        code: \"\"\n      },\n      // Options\n      itemOption: [],\n      customerOption: [],\n      termOption: [],\n      dialog: true,\n      notifications: false,\n      sound: true,\n      widgets: false,\n      labelPosition: \"left\",\n      options: {\n        disabledDate: function (time) {\n          return false;\n        }\n      },\n      disabledDate: false,\n      closeDate: \"\",\n      type: \"\",\n      posSaleMartDetail: {},\n      discountTypeOption: [{\n        label: \"amountDiscount\",\n        value: \"Amount\"\n      }, {\n        label: \"percent\",\n        value: \"Percent\"\n      }],\n      tableOption: [],\n      disabledItem: true,\n      timeStamp: [],\n      takeBarcode: '',\n      skip: 0,\n      waterBillingSetup: {},\n      username: Meteor.user().username,\n      todaySt: \"\",\n      timeSt: \"\",\n      isCategoryData: false,\n      qty: 0,\n      rules: {// code: [{required: true, message: 'Please input name', trigger: 'blur'}],\n      }\n    };\n  },\n  mounted: function () {\n    var _this = this;\n\n    this.$jQuery('body').off();\n    var vm = this;\n    var elem = this.$jQuery('.pos_SaleMart');\n\n    var checkEvent = $._data($('body').get(0), 'events');\n\n    if (checkEvent.keyup.length <= 1) {\n      this.$nextTick(function () {\n        _this.$jQuery('body').on('keydown', elem, _this.inputHandler);\n      });\n    }\n\n    this.$jQuery('body').on('focus', 'input[type=number]', function (e) {\n      $(this).on('wheel', function (e) {\n        e.preventDefault();\n      });\n    });\n    this.time();\n  },\n  watch: {\n    dialogUpdatePosSaleMart: function (val) {\n      if (val) {\n        this._inputMaskPosSaleMart();\n      }\n    },\n    \"posSaleMartForm.discount\": function (val) {\n      if (val || val === 0) {\n        this.posSaleMartForm.discount = val; // this.posSaleMartForm.discount = this.$_numeral(val).format(\"0,00\");\n\n        this.getTotal();\n      }\n    },\n    \"posSaleMartForm.discountType\": function (val) {\n      if (val) {\n        this.posSaleMartForm.discountType = val;\n        this.getTotal();\n      }\n    },\n    \"posSaleMartForm.tableId\": function (val) {\n      this.findInvoiceActiveByTableId(val);\n    }\n  },\n  methods: {\n    clickTHB: function (val) {\n      this.posSaleMartForm.paidTHB = this.$_numeral(val).value();\n      this.getTotal();\n    },\n    clickUSD: function (val) {\n      this.posSaleMartForm.paidUSD = this.$_numeral(val).value();\n      this.getTotal();\n    },\n    clickKHR: function (val) {\n      this.posSaleMartForm.paidKHR = this.$_numeral(val).value();\n      this.getTotal();\n    },\n    goToInvoice: function () {\n      FlowRouter.go(\"/pos-sale/posInvoice\");\n    },\n    time: function () {\n      var self = this;\n      this.todaySt = moment().format(\"DD/MM/YYYY\");\n      this.timeSt = moment().format(\"hh:mm:ss\");\n      setTimeout(self.time, 1000);\n    },\n    _inputMaskPosSaleMart: function () {\n      /*setTimeout(() => {\n          if ($(\".el-inputAmount\").length) {\n              new this.$_Cleave('.el-inputAmount', {\n                  numeral: true,\n                  numeralThousandsGroupStyle: 'thousand'\n              });\n          }\n           if ($(\".el-inputDR\").length) {\n              new this.$_Cleave('.el-inputDR', {\n                  numeral: true,\n                  numeralThousandsGroupStyle: 'thousand'\n              });\n          }\n           if ($(\".el-inputCR\").length) {\n              new this.$_Cleave('.el-inputCR', {\n                  numeral: true,\n                  numeralThousandsGroupStyle: 'thousand'\n              });\n          }\n        }, 200)*/\n    },\n    inputHandler: function (e) {\n      var vm = this;\n\n      if (e.data.init(0).selector === \".pos_SaleMart\") {\n        if (vm.dialogPayMoney === false) {\n          if (e.keyCode === 13 && e.ctrlKey) {\n            e.preventDefault();\n            vm.savePosSaleMart(false, e, false);\n          } else if (e.keyCode === 27 && !e.ctrlKey && !e.altKey) {\n            e.preventDefault();\n            vm.resetForm();\n          } else if (e.keyCode === 107 && !e.ctrlKey && !e.altKey) {\n            e.preventDefault();\n            vm.dialogPayMoney = true;\n          }\n        } else {\n          if (e.keyCode === 13) {\n            e.preventDefault();\n            vm.savePosSaleMart(false, e, true);\n          }\n        }\n      }\n    },\n\n    /* barcodeScanSaleMart(e) {\n         if (this.dialogAddPosSaleMart === true || this.dialogUpdatePosSaleMart === true) {\n             let scannerSensitivity = 100;\n             if (e.keyCode !== 13 && !isNaN(e.key)) {\n                 this.takeBarcode += e.key;\n             }\n             this.timeStamp.push(Date.now());\n             if (this.timeStamp.length > 1) {\n                 if (this.timeStamp[1] - this.timeStamp[0] >= scannerSensitivity) {\n                     this.takeBarcode = '';\n                     this.timeStamp = [];\n                 } else {\n                     if (e.keyCode === 13) {\n                         this.posSaleMartForm.code = this.takeBarcode;\n                         this.addToPosSaleMartData(null);\n                         this.timeStamp = [];\n                         this.takeBarcode = ''\n                     }\n                 }\n             }\n         }\n     },*/\n    queryProduct: function () {\n      var _this2 = this;\n\n      Meteor.call('queryPosProductAll', function (err, result) {\n        _this2.productDataAll = result;\n      });\n    },\n    queryProductByCodeId: function () {\n      var vm = this;\n\n      if (vm.posSaleMartForm.code !== \"\") {\n        var findProduct = function (element) {\n          if (element.barcode === vm.posSaleMartForm.code || element.code === vm.posSaleMartForm.code) {\n            return element;\n          }\n        };\n\n        var pro = this.productDataAll.find(findProduct);\n\n        if (pro) {\n          vm.addToPosSaleMartData(1, pro);\n          vm.posSaleMartForm.code = \"\";\n        } else {\n          this.$message({\n            type: 'warning',\n            message: 'លេខកូដគ្នានការប្រើប្រាស់ទេ!'\n          });\n        }\n      }\n    },\n    customerOpt: function (query) {\n      var _this3 = this;\n\n      if (!!query) {\n        setTimeout(function () {\n          var lists = [];\n          Meteor.call('queryPosCustomerOption', query, Session.get(\"area\"), function (err, result) {\n            if (!err) {\n              _this3.customerOption = result;\n            } else {\n              console.log(err.message);\n            }\n          });\n        }, 200);\n      } else {\n        Meteor.call('queryPosCustomerOption', \"\", Session.get(\"area\"), function (err, result) {\n          if (!err) {\n            _this3.customerOption = result;\n          } else {\n            console.log(err.message);\n          }\n        });\n      }\n    },\n    termOpt: function () {\n      var _this4 = this;\n\n      var selector = {};\n      Meteor.call('queryPosTermOption', selector, function (err, result) {\n        _this4.termOption = result;\n      });\n    },\n\n    /*checkValidatedNumber() {\n        let charCode = (val.which) ? val.which : val.keyCode;\n        if ($(val.currentTarget).val().indexOf('.') != -1) {\n            if (charCode == 46) {\n                return false;\n            }\n        }\n        return !(charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57));\n     },*/\n    savePosSaleMart: function (isCloseDialog, event, isPrint) {\n      var _this5 = this;\n\n      event.preventDefault();\n      var vm = this;\n      this.$refs[\"posSaleMartFormAdd\"].validate(function (valid) {\n        if (valid) {\n          var posSaleMartDoc = {\n            total: vm.$_numeral(vm.posSaleMartForm.total).value(),\n            netTotal: vm.$_numeral(vm.posSaleMartForm.netTotal).value(),\n            balanceUnPaid: vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(),\n            paid: vm.$_numeral(vm.posSaleMartForm.netTotal).value() - vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(),\n            paidUSD: vm.$_numeral(vm.posSaleMartForm.paidUSD).value(),\n            paidKHR: vm.$_numeral(vm.posSaleMartForm.paidKHR).value(),\n            paidTHB: vm.$_numeral(vm.posSaleMartForm.paidTHB).value(),\n            remainUSD: vm.$_numeral(vm.posSaleMartForm.remainUSD).value(),\n            remainKHR: vm.$_numeral(vm.posSaleMartForm.remainKHR).value(),\n            remainTHB: vm.$_numeral(vm.posSaleMartForm.remainTHB).value(),\n            invoiceDate: moment(vm.posSaleMartForm.invoiceDate).toDate(),\n            invoiceDateName: moment(vm.posSaleMartForm.invoiceDate).format(\"DD/MM/YYYY\"),\n            dueDate: moment(vm.posSaleMartForm.dueDate).toDate(),\n            invoiceNo: vm.posSaleMartForm.invoiceNo,\n            note: vm.posSaleMartForm.note,\n            discountType: vm.posSaleMartForm.discountType,\n            discount: vm.$_numeral(vm.posSaleMartForm.discount).value(),\n            discountValue: vm.$_numeral(vm.posSaleMartForm.discountValue).value(),\n            termId: \"001\",\n            address: vm.posSaleMartForm.address,\n            rolesArea: Session.get('area'),\n            paymentNumber: 1,\n            customerId: \"001\",\n            locationId: \"001\",\n            status: vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() === 0 ? \"Complete\" : vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() < vm.$_numeral(vm.posSaleMartForm.netTotal).value() ? \"Partial\" : \"Active\"\n          };\n          posSaleMartDoc.item = vm.posSaleMartData;\n\n          if (vm.posInvoiceId === \"\") {\n            Meteor.call(\"insertPosInvoice\", posSaleMartDoc, function (err, result) {\n              if (!err) {\n                if (isPrint) {\n                  FlowRouter.go('/pos-data/posInvoiceSmall/print?inv=' + result);\n                } else {\n                  vm.$message({\n                    duration: 1000,\n                    message: _this5.langConfig['saveSuccess'],\n                    type: 'success'\n                  });\n                }\n\n                vm.getVoucherByRoleAndDate(moment().toDate());\n                Session.set(\"transactionActionNumber\", (Session.get(\"transactionActionNumber\") || 0) + 1);\n                vm.resetForm();\n                vm.dialogPayMoney = false;\n              } else {\n                vm.$notify.error({\n                  duration: 5000,\n                  title: 'Error',\n                  message: err.error\n                });\n                /*vm.$message({\n                    type: 'error',\n                    message: err.error\n                });*/\n              }\n            });\n          } else {\n            Meteor.call(\"updatePosInvoice\", posSaleMartDoc, vm.posInvoiceId, function (err, result) {\n              if (!err) {\n                if (isPrint) {\n                  FlowRouter.go('/pos-data/posInvoiceSmall/print?inv=' + vm.posInvoiceId);\n                } else {\n                  vm.$message({\n                    duration: 1000,\n                    message: _this5.langConfig['saveSuccess'],\n                    type: 'success'\n                  });\n                }\n\n                vm.getVoucherByRoleAndDate(moment().toDate());\n                Session.set(\"transactionActionNumber\", (Session.get(\"transactionActionNumber\") || 0) + 1);\n                vm.resetForm();\n                vm.dialogPayMoney = false;\n              } else {\n                vm.$notify.error({\n                  duration: 5000,\n                  title: 'Error',\n                  message: err.error\n                });\n              }\n            });\n          }\n        }\n      });\n    },\n    getVoucherByRoleAndDate: function (date) {\n      var vm = this;\n      Meteor.call(\"pos_getInvoiceNoByRoleAndDate\", Session.get(\"area\"), date, function (err, result) {\n        if (!err) {\n          vm.posSaleMartForm.invoiceNo = result;\n        }\n      });\n    },\n    addToPosSaleMartData: function (val, data) {\n      var vm = this;\n      var isFound = vm.posSaleMartData.find(function (element) {\n        return element.itemId === data._id && element.type === data.type;\n      });\n      var indProduct = vm.productData.findIndex(function (k) {\n        return k._id === data._id;\n      });\n      var indProductAll = vm.productDataAll.findIndex(function (k) {\n        return k._id === data._id;\n      });\n\n      if (data.type === \"S\") {\n        if (indProduct !== -1) {\n          vm.productData[indProduct].smallQty = val;\n          vm.productData[indProduct].qty = val;\n        }\n\n        vm.productDataAll[indProductAll].smallQty = val;\n        vm.productDataAll[indProductAll].qty = val;\n        vm.productDataAll[indProductAll].type = \"S\";\n        vm.productDataAll[indProductAll].disableInputQty = false;\n      } else if (data.type === \"L\") {\n        if (indProduct !== -1) {\n          vm.productData[indProduct].largeQty = val;\n          vm.productData[indProduct].qty = val;\n        }\n\n        vm.productDataAll[indProductAll].largeQty = val;\n        vm.productDataAll[indProductAll].qty = val;\n        vm.productDataAll[indProductAll].type = \"L\";\n        vm.productDataAll[indProductAll].disableInputQty = false;\n      }\n\n      if (isFound !== undefined) {\n        this.$message({\n          type: 'warning',\n          message: 'កែប្រែចំនួន!'\n        });\n        var ind = vm.posSaleMartData.findIndex(function (k) {\n          return k.itemId === data._id && k.type === data.type;\n        });\n        isFound.qty = val;\n        isFound.totalUnit = val;\n        isFound.amount = val * isFound.price;\n        vm.posSaleMartData[ind] = isFound;\n\n        if (val === 0) {\n          vm.posSaleMartData.splice(ind, 1);\n        }\n      } else {\n        vm.posSaleMartData.push({\n          itemId: data._id,\n          itemName: data.name,\n          code: data.code,\n          unit1: 1,\n          unit2: 1,\n          totalUnit: val,\n          unitId: data.unitId,\n          unitName: data.unitName,\n          price: data.type === \"S\" ? vm.$_numeral(data.rePrice).value() : vm.$_numeral(data.whPrice).value(),\n          qty: val,\n          amount: data.type === \"S\" ? formatCurrency(data.rePrice * val) : formatCurrency(data.whPrice * val),\n          isRetail: true,\n          desc: \"\",\n          rawQty: 0,\n          type: data.type\n        });\n        vm.$message({\n          duration: 1000,\n          message: \"\\u1794\\u1793\\u17D2\\u1790\\u17C2\\u1798 \" + data.code + \" : \" + data.name + \" បានជោគជ័យ !\",\n          type: 'success'\n        });\n      }\n\n      this.getTotal();\n    },\n    updatePosSaleMartDetail: function (row, index, val) {\n      console.log(row);\n      console.log(val);\n      var vm = this;\n      row.totalUnit = this.$_math.round(row.unit1 * row.unit2 * val, 2);\n      row.amount = formatCurrency(row.price * row.totalUnit);\n      row.qty = formatCurrency(val);\n      var indProduct = vm.productData.findIndex(function (k) {\n        return k._id === row.itemId;\n      });\n      var indProductAll = vm.productDataAll.findIndex(function (k) {\n        return k._id === row.itemId;\n      });\n\n      if (row.type === \"S\") {\n        if (indProduct !== -1) {\n          vm.productData[indProduct].smallQty = val;\n          vm.productData[indProduct].type = \"S\";\n        }\n\n        vm.productDataAll[indProductAll].smallQty = val;\n        vm.productDataAll[indProductAll].type = \"S\";\n      } else if (row.type === \"L\") {\n        if (indProduct !== -1) {\n          vm.productData[indProduct].largeQty = val;\n          vm.productData[indProduct].type = \"L\";\n        }\n\n        vm.productDataAll[indProductAll].largeQty = val;\n        vm.productDataAll[indProductAll].type = \"L\";\n      }\n\n      if (indProduct !== -1) {\n        vm.productData[indProduct].qty = val;\n      }\n\n      vm.productDataAll[indProductAll].qty = val;\n      vm.productDataAll[indProductAll].disableInputQty = row.type !== \"\" ? false : true;\n\n      if (indProduct !== -1) {\n        vm.productData[indProduct].disableInputQty = row.type !== \"\" ? false : true;\n      }\n\n      console.log(this.posSaleMartData);\n      console.log(\"mid\");\n      this.posSaleMartData[index] = row;\n      console.log(this.posSaleMartData);\n\n      if (val === 0) {\n        this.posSaleMartData.splice(index, 1);\n      }\n\n      console.log(\"After\");\n      console.log(this.posSaleMartData);\n      this.getTotal();\n    },\n    clearZero: function (event) {\n      /*debugger;\n      $(event.currentTarget).select();\n      console.log(event);*/\n    },\n    cancel: function () {\n      this.resetForm();\n      this.$message({\n        type: 'info',\n        message: this.langConfig['cancel']\n      });\n    },\n    resetForm: function () {\n      this.posSaleMartData = [];\n      this.posSaleMartForm.discountValue = 0;\n      this.posSaleMartForm.code = \"\";\n      this.posSaleMartForm.paidUSD = 0;\n      this.posSaleMartForm.paidKHR = 0;\n      this.posSaleMartForm.paidTHB = 0;\n      this.posSaleMartForm.discount = 0;\n      this.posSaleMartForm.customerId = \"\";\n      this.posSaleMartForm.tableId = \"\";\n      this.posSaleMartForm.balanceNotCut = 0;\n      this.posInvoiceId = \"\";\n\n      if (this.$refs[\"posSaleMartFormAdd\"]) {\n        this.$refs[\"posSaleMartFormAdd\"].resetFields();\n      }\n\n      this.getTotal();\n    },\n    getTotal: function () {\n      var vm = this;\n      var total = 0;\n      vm.posSaleMartData.forEach(function (obj) {\n        total += parseFloat(vm.$_numeral(obj.amount).value());\n      });\n\n      if (total >= vm.$_numeral(vm.posSaleMartForm.balanceNotCutFull).value()) {\n        vm.posSaleMartForm.balanceNotCut = vm.posSaleMartForm.balanceNotCutFull;\n      } else {\n        vm.posSaleMartForm.balanceNotCut = formatCurrency(total);\n      }\n\n      var companyDoc = WB_waterBillingSetup.findOne({});\n      vm.posSaleMartForm.total = formatCurrencyLast(total, companyDoc.baseCurrency);\n\n      if (vm.posSaleMartForm.discountType === \"Amount\") {\n        vm.posSaleMartForm.netTotal = formatCurrencyLast(total - vm.posSaleMartForm.discount, companyDoc.baseCurrency);\n        vm.posSaleMartForm.balanceUnPaid = formatCurrencyLast(total - vm.posSaleMartForm.discount - vm.$_numeral(vm.posSaleMartForm.balanceNotCut).value() - GeneralFunction.exchange(\"USD\", companyDoc.baseCurrency, vm.posSaleMartForm.paidUSD, Session.get(\"area\")) - GeneralFunction.exchange(\"KHR\", companyDoc.baseCurrency, vm.posSaleMartForm.paidKHR, Session.get(\"area\")) - GeneralFunction.exchange(\"THB\", companyDoc.baseCurrency, vm.posSaleMartForm.paidTHB, Session.get(\"area\")), companyDoc.baseCurrency);\n        vm.posSaleMartForm.remainUSD = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"USD\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"USD\");\n        vm.posSaleMartForm.remainKHR = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"KHR\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"KHR\");\n        vm.posSaleMartForm.remainTHB = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"THB\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"THB\");\n        vm.posSaleMartForm.discountValue = formatCurrencyLast(vm.posSaleMartForm.discount, companyDoc.baseCurrency);\n        vm.posSaleMartForm.balanceUnPaid = vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() <= 0 ? 0 : vm.posSaleMartForm.balanceUnPaid;\n        this.typeDiscount = getCurrencySymbolById(companyDoc.baseCurrency);\n      } else {\n        vm.posSaleMartForm.netTotal = formatCurrencyLast(total - total * vm.posSaleMartForm.discount / 100, companyDoc.baseCurrency);\n        vm.posSaleMartForm.balanceUnPaid = formatCurrencyLast(total - total * vm.posSaleMartForm.discount / 100 - GeneralFunction.exchange(\"USD\", companyDoc.baseCurrency, vm.posSaleMartForm.paidUSD, Session.get(\"area\")) - GeneralFunction.exchange(\"KHR\", companyDoc.baseCurrency, vm.posSaleMartForm.paidKHR, Session.get(\"area\")) - GeneralFunction.exchange(\"THB\", companyDoc.baseCurrency, vm.posSaleMartForm.paidTHB, Session.get(\"area\")), companyDoc.baseCurrency);\n        vm.posSaleMartForm.remainUSD = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"USD\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"USD\");\n        vm.posSaleMartForm.remainKHR = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"KHR\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"KHR\");\n        vm.posSaleMartForm.remainTHB = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"THB\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"THB\");\n        vm.posSaleMartForm.discountValue = formatCurrencyLast(total * vm.posSaleMartForm.discount / 100, companyDoc.baseCurrency);\n        vm.posSaleMartForm.balanceUnPaid = vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() <= 0 ? 0 : vm.posSaleMartForm.balanceUnPaid;\n        this.typeDiscount = \"%\";\n      }\n    },\n    printSaleMart: function (data) {\n      if (data.transactionType === \"SaleMart Sale Order\") {\n        FlowRouter.go('/pos-data/posSaleMartReceiveItem/print?inv=' + data._id);\n      } else {\n        FlowRouter.go('/pos-data/posSaleMart/print?inv=' + data._id);\n      }\n    },\n    handleChange: function (data, e) {\n      this.addToPosSaleMartData(e, data);\n    },\n    handleClickBtn: function (data, btn, index) {\n      data.type = btn;\n      data.disableInputQty = data.type !== \"\" ? false : true;\n\n      if (data.type === \"S\") {\n        data.qty = data.smallQty === 0 ? 1 : data.smallQty;\n      } else if (data.type === \"L\") {\n        data.qty = data.largeQty === 0 ? 1 : data.largeQty;\n      }\n\n      this.addToPosSaleMartData(data.qty, data);\n      this.productData[index] = data;\n    }\n  },\n  created: function () {\n    var _this6 = this;\n\n    this.isSearching = true;\n    this.getTotal();\n    this.queryProduct();\n    Meteor.subscribe('Pos_InvoiceReact');\n    this.getVoucherByRoleAndDate(moment().toDate());\n    Meteor.call('getWaterBillingSetup', Session.get('area'), function (err, result) {\n      if (result) {\n        _this6.waterBillingSetup = result;\n        _this6.currencySymbol = getCurrencySymbolById(result.baseCurrency);\n      }\n    });\n  },\n  computed: {\n    langConfig: function () {\n      var _this7 = this;\n\n      var data = compoLang.filter(function (config) {\n        return config.lang === _this7.langSession;\n      })[0]['saleMart'];\n      return data;\n    }\n  }\n});","map":{"version":3,"sources":["/home/snr/Desktop/Project/activity/imports/vue/ui/posSaleMart.vue"],"names":["draggable","module","link","v","formatCurrency","formatCurrencyLast","GeneralFunction","getCurrencySymbolById","WB_waterBillingSetup","compoLang","Pos_InvoiceReact","exportDefault","meteor","langSession","Session","get","disabledRemove","disabledUpdate","components","data","keyCode","refForm","multipleSelection","posInvoiceId","loading","searchData","isSearching","typeDiscount","categoryData","productData","productDataAll","currencySymbol","posSaleMartData","dialogPayMoney","posSaleMartForm","itemId","itemName","price","qty","amount","total","netTotal","balanceUnPaid","paid","invoiceDate","moment","toDate","dueDate","add","invoiceNo","note","discountType","discount","discountValue","termId","address","customerId","isRetail","paidUSD","paidKHR","paidTHB","remainUSD","remainKHR","remainTHB","unit1","unit2","totalUnit","desc","tableId","rawQty","isReceiveAll","balanceNotCut","balanceNotCutFull","code","itemOption","customerOption","termOption","dialog","notifications","sound","widgets","labelPosition","options","disabledDate","time","closeDate","type","posSaleMartDetail","discountTypeOption","label","value","tableOption","disabledItem","timeStamp","takeBarcode","skip","waterBillingSetup","username","Meteor","user","todaySt","timeSt","isCategoryData","rules","mounted","$jQuery","off","vm","elem","checkEvent","$","_data","keyup","length","$nextTick","on","inputHandler","e","preventDefault","watch","dialogUpdatePosSaleMart","val","_inputMaskPosSaleMart","getTotal","findInvoiceActiveByTableId","methods","clickTHB","$_numeral","clickUSD","clickKHR","goToInvoice","FlowRouter","go","self","format","setTimeout","init","selector","ctrlKey","savePosSaleMart","altKey","resetForm","queryProduct","call","err","result","queryProductByCodeId","findProduct","element","barcode","pro","find","addToPosSaleMartData","$message","message","customerOpt","query","lists","console","log","termOpt","isCloseDialog","event","isPrint","$refs","validate","valid","posSaleMartDoc","invoiceDateName","rolesArea","paymentNumber","locationId","status","item","duration","langConfig","getVoucherByRoleAndDate","set","$notify","error","title","date","isFound","_id","indProduct","findIndex","k","indProductAll","smallQty","disableInputQty","largeQty","undefined","ind","splice","push","name","unitId","unitName","rePrice","whPrice","updatePosSaleMartDetail","row","index","$_math","round","clearZero","cancel","resetFields","forEach","obj","parseFloat","companyDoc","findOne","baseCurrency","exchange","printSaleMart","transactionType","handleChange","handleClickBtn","btn","created","subscribe","computed","filter","config","lang"],"mappings":"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","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport draggable from 'vuedraggable';\nimport {formatCurrency} from \"../../../imports/api/methods/roundCurrency\";\nimport {formatCurrencyLast} from \"../../../imports/api/methods/roundCurrency\";\nimport {GeneralFunction} from \"../../../imports/api/methods/generalFunction\";\nimport {getCurrencySymbolById} from \"../../../imports/api/methods/roundCurrency\";\nimport {WB_waterBillingSetup} from \"../../collection/waterBillingSetup\";\n// require('cleave.js/dist/addons/cleave-phone.ac');\n// require('cleave.js/dist/addons/cleave-phone.{country}');\nimport compoLang from '../../../both/i18n/lang/elem-label'\nimport {Pos_InvoiceReact} from \"../../collection/posInvoice\";\n\nexport default {\n    meteor: {\n        langSession() {\n            return Session.get('lang') || \"en\";\n        },\n        disabledRemove() {\n            return Session.get(\"canRemove\");\n        },\n        disabledUpdate() {\n            return Session.get(\"canUpdate\");\n        }\n    },\n    components: {\n        draggable\n    },\n    data() {\n        return {\n            keyCode: [],\n            refForm: 'posSaleMartFormAdd',\n            multipleSelection: [],\n            posInvoiceId: \"\",\n            loading: false,\n            searchData: '',\n            isSearching: false,\n            typeDiscount: \"\",\n            categoryData: [],\n            productData: [],\n            productDataAll: [],\n            currencySymbol: \"\",\n            posSaleMartData: [],\n            dialogPayMoney: false,\n\n            posSaleMartForm: {\n                itemId: \"\",\n                itemName: \"\",\n                price: 0,\n                qty: 0,\n                amount: 0,\n                total: 0,\n                netTotal: 0,\n                balanceUnPaid: 0,\n                paid: 0,\n                invoiceDate: moment().toDate(),\n                dueDate: moment().add(1, \"month\").toDate(),\n                invoiceNo: \"\",\n\n                note: \"\",\n\n                discountType: \"Amount\",\n                discount: 0,\n                discountValue: 0,\n                termId: \"\",\n                address: \"\",\n                customerId: \"\",\n\n                isRetail: true,\n                paidUSD: 0,\n                paidKHR: 0,\n                paidTHB: 0,\n\n                remainUSD: 0,\n                remainKHR: 0,\n                remainTHB: 0,\n                unit1: 1,\n                unit2: 1,\n                totalUnit: 1,\n                desc: \"\",\n                tableId: \"\",\n                rawQty: 0,\n                isReceiveAll: false,\n                balanceNotCut: 0,\n                balanceNotCutFull: 0,\n                code: \"\"\n\n            },\n\n            // Options\n            itemOption: [],\n            customerOption: [],\n            termOption: [],\n\n            dialog: true,\n            notifications: false,\n            sound: true,\n            widgets: false,\n            labelPosition: \"left\",\n            options: {\n                disabledDate(time) {\n                    return false;\n                }\n            },\n            disabledDate: false,\n            closeDate: \"\",\n            type: \"\",\n            posSaleMartDetail: {},\n            discountTypeOption: [\n                {label: \"amountDiscount\", value: \"Amount\"},\n                {label: \"percent\", value: \"Percent\"}\n            ],\n            tableOption: [],\n            disabledItem: true,\n            timeStamp: [],\n            takeBarcode: '',\n            skip: 0,\n            waterBillingSetup: {},\n            username: Meteor.user().username,\n            todaySt: \"\",\n            timeSt: \"\",\n            isCategoryData: false,\n            qty: 0,\n            rules: {\n                // code: [{required: true, message: 'Please input name', trigger: 'blur'}],\n            },\n        }\n    },\n    mounted() {\n        this.$jQuery('body').off();\n        let vm = this;\n\n        let elem = this.$jQuery('.pos_SaleMart');\n        let checkEvent = $._data($('body').get(0), 'events');\n        if (checkEvent.keyup.length <= 1) {\n            this.$nextTick(() => {\n                this.$jQuery('body').on('keydown', elem, this.inputHandler);\n            })\n        }\n        this.$jQuery('body').on('focus', 'input[type=number]', function(e) {\n            $(this).on('wheel', function(e) {\n                e.preventDefault();\n            });\n        });\n        this.time();\n    },\n    watch: {\n        dialogUpdatePosSaleMart(val) {\n            if (val) {\n                this._inputMaskPosSaleMart();\n            }\n        },\n        \"posSaleMartForm.discount\"(val) {\n            if (val || val === 0) {\n                this.posSaleMartForm.discount = val;\n                // this.posSaleMartForm.discount = this.$_numeral(val).format(\"0,00\");\n                this.getTotal();\n\n            }\n        },\n        \"posSaleMartForm.discountType\"(val) {\n            if (val) {\n                this.posSaleMartForm.discountType = val;\n                this.getTotal();\n            }\n        },\n        \"posSaleMartForm.tableId\"(val) {\n            this.findInvoiceActiveByTableId(val);\n        }\n    },\n    methods: {\n        clickTHB(val) {\n            this.posSaleMartForm.paidTHB = this.$_numeral(val).value();\n            this.getTotal();\n        },\n        clickUSD(val) {\n            this.posSaleMartForm.paidUSD = this.$_numeral(val).value();\n            this.getTotal();\n        },\n        clickKHR(val) {\n            this.posSaleMartForm.paidKHR = this.$_numeral(val).value();\n            this.getTotal();\n        },\n        goToInvoice() {\n            FlowRouter.go(\"/pos-sale/posInvoice\");\n        },\n        time() {\n            let self = this;\n            this.todaySt = moment().format(\"DD/MM/YYYY\");\n            this.timeSt = moment().format(\"hh:mm:ss\");\n            setTimeout(self.time, 1000);\n        },\n        _inputMaskPosSaleMart() {\n            /*setTimeout(() => {\n                if ($(\".el-inputAmount\").length) {\n                    new this.$_Cleave('.el-inputAmount', {\n                        numeral: true,\n                        numeralThousandsGroupStyle: 'thousand'\n                    });\n                }\n\n                if ($(\".el-inputDR\").length) {\n                    new this.$_Cleave('.el-inputDR', {\n                        numeral: true,\n                        numeralThousandsGroupStyle: 'thousand'\n                    });\n                }\n\n                if ($(\".el-inputCR\").length) {\n                    new this.$_Cleave('.el-inputCR', {\n                        numeral: true,\n                        numeralThousandsGroupStyle: 'thousand'\n                    });\n                }\n\n\n            }, 200)*/\n        },\n        inputHandler(e) {\n            let vm = this;\n            if (e.data.init(0).selector === \".pos_SaleMart\") {\n                if (vm.dialogPayMoney === false) {\n                    if (e.keyCode === 13 && e.ctrlKey) {\n                        e.preventDefault();\n                        vm.savePosSaleMart(false, e, false);\n\n                    } else if (e.keyCode === 27 && !e.ctrlKey && !e.altKey) {\n                        e.preventDefault();\n                        vm.resetForm();\n\n                    } else if (e.keyCode === 107 && !e.ctrlKey && !e.altKey) {\n                        e.preventDefault();\n                        vm.dialogPayMoney = true;\n\n                    }\n                } else {\n                    if (e.keyCode === 13) {\n                        e.preventDefault();\n                        vm.savePosSaleMart(false, e, true);\n                    }\n                }\n            }\n\n        },\n        /* barcodeScanSaleMart(e) {\n             if (this.dialogAddPosSaleMart === true || this.dialogUpdatePosSaleMart === true) {\n                 let scannerSensitivity = 100;\n                 if (e.keyCode !== 13 && !isNaN(e.key)) {\n                     this.takeBarcode += e.key;\n                 }\n                 this.timeStamp.push(Date.now());\n                 if (this.timeStamp.length > 1) {\n                     if (this.timeStamp[1] - this.timeStamp[0] >= scannerSensitivity) {\n                         this.takeBarcode = '';\n                         this.timeStamp = [];\n                     } else {\n                         if (e.keyCode === 13) {\n                             this.posSaleMartForm.code = this.takeBarcode;\n                             this.addToPosSaleMartData(null);\n                             this.timeStamp = [];\n                             this.takeBarcode = ''\n                         }\n                     }\n                 }\n             }\n         },*/\n\n        queryProduct() {\n            Meteor.call('queryPosProductAll', (err, result) => {\n                this.productDataAll = result;\n            })\n        },\n        queryProductByCodeId() {\n            let vm = this;\n            if (vm.posSaleMartForm.code !== \"\") {\n                let findProduct = function (element) {\n                    if (element.barcode === vm.posSaleMartForm.code || element.code === vm.posSaleMartForm.code) {\n                        return element;\n                    }\n                }\n                let pro = this.productDataAll.find(findProduct);\n                if (pro) {\n                    vm.addToPosSaleMartData(1, pro);\n                    vm.posSaleMartForm.code = \"\";\n                } else {\n                    this.$message({\n                        type: 'warning',\n                        message: 'លេខកូដគ្នានការប្រើប្រាស់ទេ!'\n                    });\n                }\n            }\n        },\n        customerOpt(query) {\n            if (!!query) {\n                setTimeout(() => {\n                    let lists = [];\n                    Meteor.call('queryPosCustomerOption', query, Session.get(\"area\"), (err, result) => {\n                        if (!err) {\n                            this.customerOption = result;\n                        } else {\n                            console.log(err.message);\n                        }\n                    })\n                }, 200);\n            } else {\n                Meteor.call('queryPosCustomerOption', \"\", Session.get(\"area\"), (err, result) => {\n                    if (!err) {\n                        this.customerOption = result;\n                    } else {\n                        console.log(err.message);\n                    }\n                })\n            }\n        },\n        termOpt() {\n            let selector = {};\n            Meteor.call('queryPosTermOption', selector, (err, result) => {\n                this.termOption = result;\n            })\n        },\n        /*checkValidatedNumber() {\n            let charCode = (val.which) ? val.which : val.keyCode;\n            if ($(val.currentTarget).val().indexOf('.') != -1) {\n                if (charCode == 46) {\n                    return false;\n                }\n            }\n            return !(charCode != 46 && charCode > 31 && (charCode < 48 || charCode > 57));\n\n        },*/\n        savePosSaleMart(isCloseDialog, event, isPrint) {\n            event.preventDefault();\n            let vm = this;\n            this.$refs[\"posSaleMartFormAdd\"].validate((valid) => {\n                if (valid) {\n                    let posSaleMartDoc = {\n                        total: vm.$_numeral(vm.posSaleMartForm.total).value(),\n                        netTotal: vm.$_numeral(vm.posSaleMartForm.netTotal).value(),\n                        balanceUnPaid: vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(),\n                        paid: vm.$_numeral(vm.posSaleMartForm.netTotal).value() - vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(),\n\n                        paidUSD: vm.$_numeral(vm.posSaleMartForm.paidUSD).value(),\n                        paidKHR: vm.$_numeral(vm.posSaleMartForm.paidKHR).value(),\n                        paidTHB: vm.$_numeral(vm.posSaleMartForm.paidTHB).value(),\n\n                        remainUSD: vm.$_numeral(vm.posSaleMartForm.remainUSD).value(),\n                        remainKHR: vm.$_numeral(vm.posSaleMartForm.remainKHR).value(),\n                        remainTHB: vm.$_numeral(vm.posSaleMartForm.remainTHB).value(),\n\n                        invoiceDate: moment(vm.posSaleMartForm.invoiceDate).toDate(),\n                        invoiceDateName: moment(vm.posSaleMartForm.invoiceDate).format(\"DD/MM/YYYY\"),\n                        dueDate: moment(vm.posSaleMartForm.dueDate).toDate(),\n                        invoiceNo: vm.posSaleMartForm.invoiceNo,\n\n                        note: vm.posSaleMartForm.note,\n\n                        discountType: vm.posSaleMartForm.discountType,\n\n\n                        discount: vm.$_numeral(vm.posSaleMartForm.discount).value(),\n                        discountValue: vm.$_numeral(vm.posSaleMartForm.discountValue).value(),\n                        termId: \"001\",\n                        address: vm.posSaleMartForm.address,\n\n                        rolesArea: Session.get('area'),\n                        paymentNumber: 1,\n                        customerId: \"001\",\n                        locationId: \"001\",\n                        status: vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() === 0 ? \"Complete\" : vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() < vm.$_numeral(vm.posSaleMartForm.netTotal).value() ? \"Partial\" : \"Active\"\n                    };\n                    posSaleMartDoc.item = vm.posSaleMartData;\n                    if (vm.posInvoiceId === \"\") {\n                        Meteor.call(\"insertPosInvoice\", posSaleMartDoc, (err, result) => {\n                            if (!err) {\n                                if (isPrint) {\n                                    FlowRouter.go('/pos-data/posInvoiceSmall/print?inv=' + result);\n                                } else {\n                                    vm.$message({\n                                        duration: 1000,\n                                        message: this.langConfig['saveSuccess'],\n                                        type: 'success'\n                                    });\n                                }\n\n                                vm.getVoucherByRoleAndDate(moment().toDate());\n                                Session.set(\"transactionActionNumber\", (Session.get(\"transactionActionNumber\") || 0) + 1);\n\n                                vm.resetForm();\n                                vm.dialogPayMoney = false;\n                            } else {\n                                vm.$notify.error({\n                                    duration: 5000,\n                                    title: 'Error',\n                                    message: err.error\n                                });\n                                /*vm.$message({\n                                    type: 'error',\n                                    message: err.error\n                                });*/\n                            }\n                        })\n                    } else {\n                        Meteor.call(\"updatePosInvoice\", posSaleMartDoc, vm.posInvoiceId, (err, result) => {\n                            if (!err) {\n                                if (isPrint) {\n                                    FlowRouter.go('/pos-data/posInvoiceSmall/print?inv=' + vm.posInvoiceId);\n                                } else {\n                                    vm.$message({\n                                        duration: 1000,\n                                        message: this.langConfig['saveSuccess'],\n                                        type: 'success'\n                                    });\n                                }\n                                vm.getVoucherByRoleAndDate(moment().toDate());\n                                Session.set(\"transactionActionNumber\", (Session.get(\"transactionActionNumber\") || 0) + 1);\n                                vm.resetForm();\n                                vm.dialogPayMoney = false;\n                            } else {\n                                vm.$notify.error({\n                                    duration: 5000,\n                                    title: 'Error',\n                                    message: err.error\n                                });\n                            }\n                        })\n                    }\n\n                }\n            })\n\n\n        },\n\n        getVoucherByRoleAndDate(date) {\n            let vm = this;\n            Meteor.call(\"pos_getInvoiceNoByRoleAndDate\", Session.get(\"area\"), date, (err, result) => {\n                if (!err) {\n                    vm.posSaleMartForm.invoiceNo = result;\n                }\n            })\n        },\n        addToPosSaleMartData(val, data) {\n            let vm = this;\n            let isFound = vm.posSaleMartData.find(function (element) {\n                return element.itemId === data._id && element.type === data.type;\n            });\n            let indProduct = vm.productData.findIndex(k => k._id === data._id);\n            let indProductAll = vm.productDataAll.findIndex(k => k._id === data._id);\n            if (data.type === \"S\") {\n                if (indProduct !== -1) {\n                    vm.productData[indProduct].smallQty = val;\n                    vm.productData[indProduct].qty = val;\n                }\n                vm.productDataAll[indProductAll].smallQty = val;\n                vm.productDataAll[indProductAll].qty = val;\n                vm.productDataAll[indProductAll].type = \"S\";\n                vm.productDataAll[indProductAll].disableInputQty = false;\n\n            } else if (data.type === \"L\") {\n                if (indProduct !== -1) {\n                    vm.productData[indProduct].largeQty = val;\n                    vm.productData[indProduct].qty = val;\n                }\n                vm.productDataAll[indProductAll].largeQty = val;\n                vm.productDataAll[indProductAll].qty = val;\n                vm.productDataAll[indProductAll].type = \"L\";\n                vm.productDataAll[indProductAll].disableInputQty = false;\n\n            }\n\n            if (isFound !== undefined) {\n                this.$message({\n                    type: 'warning',\n                    message: 'កែប្រែចំនួន!'\n                });\n\n                let ind = vm.posSaleMartData.findIndex(k => k.itemId === data._id && k.type === data.type);\n                isFound.qty = val;\n                isFound.totalUnit = val;\n                isFound.amount = val * isFound.price;\n\n                vm.posSaleMartData[ind] = isFound;\n                if (val === 0) {\n                    vm.posSaleMartData.splice(ind, 1);\n                }\n\n            } else {\n                vm.posSaleMartData.push({\n                    itemId: data._id,\n                    itemName: data.name,\n                    code: data.code,\n                    unit1: 1,\n                    unit2: 1,\n                    totalUnit: val,\n                    unitId: data.unitId,\n                    unitName: data.unitName,\n                    price: data.type === \"S\" ? vm.$_numeral(data.rePrice).value() : vm.$_numeral(data.whPrice).value(),\n                    qty: val,\n                    amount: data.type === \"S\" ? formatCurrency(data.rePrice * val) : formatCurrency(data.whPrice * val),\n                    isRetail: true,\n                    desc: \"\",\n                    rawQty: 0,\n                    type: data.type\n                });\n                vm.$message({\n                    duration: 1000,\n                    message: `បន្ថែម ` + data.code + \" : \" + data.name + \" បានជោគជ័យ !\",\n                    type: 'success'\n                });\n            }\n\n\n            this.getTotal();\n\n\n        }\n        ,\n        updatePosSaleMartDetail(row, index, val) {\n            console.log(row);\n            console.log(val);\n            let vm = this;\n            row.totalUnit = this.$_math.round(row.unit1 * row.unit2 * val, 2);\n            row.amount = formatCurrency(row.price * row.totalUnit);\n            row.qty = formatCurrency(val);\n\n            let indProduct = vm.productData.findIndex(k => k._id === row.itemId);\n            let indProductAll = vm.productDataAll.findIndex(k => k._id === row.itemId);\n            if (row.type === \"S\") {\n                if (indProduct !== -1) {\n                    vm.productData[indProduct].smallQty = val;\n                    vm.productData[indProduct].type = \"S\";\n                }\n                vm.productDataAll[indProductAll].smallQty = val;\n                vm.productDataAll[indProductAll].type = \"S\";\n\n\n            } else if (row.type === \"L\") {\n                if (indProduct !== -1) {\n                    vm.productData[indProduct].largeQty = val;\n                    vm.productData[indProduct].type = \"L\";\n                }\n                vm.productDataAll[indProductAll].largeQty = val;\n                vm.productDataAll[indProductAll].type = \"L\";\n            }\n\n            if (indProduct !== -1) {\n                vm.productData[indProduct].qty = val;\n            }\n            vm.productDataAll[indProductAll].qty = val;\n\n            vm.productDataAll[indProductAll].disableInputQty = row.type !== \"\" ? false : true;\n            if (indProduct !== -1) {\n                vm.productData[indProduct].disableInputQty = row.type !== \"\" ? false : true;\n            }\n            console.log(this.posSaleMartData);\n            console.log(\"mid\");\n            this.posSaleMartData[index] = row;\n            console.log(this.posSaleMartData);\n            if (val === 0) {\n                this.posSaleMartData.splice(index, 1);\n            }\n            console.log(\"After\");\n            console.log(this.posSaleMartData);\n\n            this.getTotal();\n        }\n        ,\n        clearZero(event) {\n            /*debugger;\n            $(event.currentTarget).select();\n            console.log(event);*/\n        }\n        ,\n        cancel() {\n            this.resetForm();\n            this.$message({\n                type: 'info',\n                message: this.langConfig['cancel']\n            });\n        }\n        ,\n        resetForm() {\n            this.posSaleMartData = [];\n            this.posSaleMartForm.discountValue = 0;\n            this.posSaleMartForm.code = \"\";\n            this.posSaleMartForm.paidUSD = 0;\n            this.posSaleMartForm.paidKHR = 0;\n            this.posSaleMartForm.paidTHB = 0;\n            this.posSaleMartForm.discount = 0;\n            this.posSaleMartForm.customerId = \"\";\n            this.posSaleMartForm.tableId = \"\";\n            this.posSaleMartForm.balanceNotCut = 0;\n\n            this.posInvoiceId = \"\";\n            if (this.$refs[\"posSaleMartFormAdd\"]) {\n                this.$refs[\"posSaleMartFormAdd\"].resetFields();\n            }\n            this.getTotal();\n\n        }\n        ,\n        getTotal() {\n            let vm = this;\n            let total = 0;\n            vm.posSaleMartData.forEach(function (obj) {\n                total += parseFloat(vm.$_numeral(obj.amount).value());\n\n            });\n            if (total >= vm.$_numeral(vm.posSaleMartForm.balanceNotCutFull).value()) {\n                vm.posSaleMartForm.balanceNotCut = vm.posSaleMartForm.balanceNotCutFull;\n            } else {\n                vm.posSaleMartForm.balanceNotCut = formatCurrency(total);\n            }\n            let companyDoc = WB_waterBillingSetup.findOne({});\n            vm.posSaleMartForm.total = formatCurrencyLast(total, companyDoc.baseCurrency);\n\n            if (vm.posSaleMartForm.discountType === \"Amount\") {\n                vm.posSaleMartForm.netTotal = formatCurrencyLast(total - vm.posSaleMartForm.discount, companyDoc.baseCurrency);\n                vm.posSaleMartForm.balanceUnPaid = formatCurrencyLast(total - vm.posSaleMartForm.discount - vm.$_numeral(vm.posSaleMartForm.balanceNotCut).value() - GeneralFunction.exchange(\"USD\", companyDoc.baseCurrency, vm.posSaleMartForm.paidUSD, Session.get(\"area\")) - GeneralFunction.exchange(\"KHR\", companyDoc.baseCurrency, vm.posSaleMartForm.paidKHR, Session.get(\"area\")) - GeneralFunction.exchange(\"THB\", companyDoc.baseCurrency, vm.posSaleMartForm.paidTHB, Session.get(\"area\")), companyDoc.baseCurrency);\n\n                vm.posSaleMartForm.remainUSD = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"USD\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"USD\");\n                vm.posSaleMartForm.remainKHR = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"KHR\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"KHR\");\n                vm.posSaleMartForm.remainTHB = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"THB\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"THB\");\n                vm.posSaleMartForm.discountValue = formatCurrencyLast(vm.posSaleMartForm.discount, companyDoc.baseCurrency);\n\n                vm.posSaleMartForm.balanceUnPaid = vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() <= 0 ? 0 : vm.posSaleMartForm.balanceUnPaid;\n                this.typeDiscount = getCurrencySymbolById(companyDoc.baseCurrency);\n            } else {\n                vm.posSaleMartForm.netTotal = formatCurrencyLast(total - (total * vm.posSaleMartForm.discount / 100), companyDoc.baseCurrency);\n                vm.posSaleMartForm.balanceUnPaid = formatCurrencyLast(total - (total * vm.posSaleMartForm.discount / 100) - GeneralFunction.exchange(\"USD\", companyDoc.baseCurrency, vm.posSaleMartForm.paidUSD, Session.get(\"area\")) - GeneralFunction.exchange(\"KHR\", companyDoc.baseCurrency, vm.posSaleMartForm.paidKHR, Session.get(\"area\")) - GeneralFunction.exchange(\"THB\", companyDoc.baseCurrency, vm.posSaleMartForm.paidTHB, Session.get(\"area\")), companyDoc.baseCurrency);\n\n                vm.posSaleMartForm.remainUSD = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"USD\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"USD\");\n                vm.posSaleMartForm.remainKHR = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"KHR\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"KHR\");\n                vm.posSaleMartForm.remainTHB = formatCurrencyLast(GeneralFunction.exchange(companyDoc.baseCurrency, \"THB\", vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value(), Session.get(\"area\")), \"THB\");\n                vm.posSaleMartForm.discountValue = formatCurrencyLast((total * vm.posSaleMartForm.discount / 100), companyDoc.baseCurrency);\n\n                vm.posSaleMartForm.balanceUnPaid = vm.$_numeral(vm.posSaleMartForm.balanceUnPaid).value() <= 0 ? 0 : vm.posSaleMartForm.balanceUnPaid;\n                this.typeDiscount = \"%\";\n            }\n        },\n        printSaleMart(data) {\n            if (data.transactionType === \"SaleMart Sale Order\") {\n                FlowRouter.go('/pos-data/posSaleMartReceiveItem/print?inv=' + data._id);\n            } else {\n                FlowRouter.go('/pos-data/posSaleMart/print?inv=' + data._id);\n            }\n\n        },\n        handleChange(data, e) {\n            this.addToPosSaleMartData(e, data);\n        },\n        handleClickBtn(data, btn, index) {\n            data.type = btn;\n            data.disableInputQty = data.type !== \"\" ? false : true;\n\n            if (data.type === \"S\") {\n                data.qty = data.smallQty === 0 ? 1 : data.smallQty;\n            } else if (data.type === \"L\") {\n                data.qty = data.largeQty === 0 ? 1 : data.largeQty;\n            }\n            this.addToPosSaleMartData(data.qty, data);\n            this.productData[index] = data;\n        }\n    },\n    created() {\n        this.isSearching = true;\n        this.getTotal();\n        this.queryProduct();\n        Meteor.subscribe('Pos_InvoiceReact');\n        this.getVoucherByRoleAndDate(moment().toDate());\n\n        Meteor.call('getWaterBillingSetup', Session.get('area'), (err, result) => {\n            if (result) {\n                this.waterBillingSetup = result;\n                this.currencySymbol = getCurrencySymbolById(result.baseCurrency);\n            }\n        })\n\n\n    },\n    computed: {\n        langConfig() {\n            let data = compoLang.filter(config => config.lang === this.langSession)[0]['saleMart'];\n            return data;\n        }\n    }\n}\n\n\n"]},"sourceType":"script","hash":"e84963c30f30f3c2ad641fe27e26b4c0d1d17b54"}
